<!DOCTYPE html>
<html lang="en">

  <head>
    
    <!-- Meta Tag -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO -->
    <meta name="description" content="scipy, scipy python, numpy scipy, import scipy, scipy функции, scipy пример, scipy питон, scipy python 3, библиотека scipy, scipy examples, scipy io">
    <meta name="author" content="labintsevai">
    <meta name="url" content="http://www.scipy-tutorial.ru">
    <meta name="copyright" content="labintsevai">
    <meta name="robots" content="index,follow">
	
	
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(51612041, "init", {
        id:51612041,
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/51612041" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
    
    <title>SciPy Ввод/вывод</title>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="images/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="144x144" type="image/x-icon" href="images/favicon/apple-touch-icon.png">
    
    <!-- All CSS Plugins -->
    <link rel="stylesheet" type="text/css" href="css/plugin.css">
    
    <!-- Main CSS Stylesheet -->
    <link rel="stylesheet" type="text/css" href="css/style.css">
    
    <!-- Google Web Fonts  -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700">
    
    <!-- Syntax Highlighter  -->
    <link rel="stylesheet" type="text/css" href="css/syntax/shCore.css">
    <link rel="stylesheet" type="text/css" href="css/syntax/shThemeDefault.css">
    
        	<!-- MathJax support-->
  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async>
</script>

    <!-- HTML5 shiv and Respond.js support IE8 or Older for HTML5 elements and media queries -->
    <!--[if lt IE 9]>
	   <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	   <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    

  </head>

 <body>

	<!-- Preloader Start -->
     <div class="preloader">
	   <div class="rounder"></div>
      </div>
      <!-- Preloader End -->
      
      
    
    
<div id="main">
<div class="container">
<div class="row">

<!-- About Me (Left Sidebar) Start -->
<div class="col-md-3">
<div class="about-fixed">

<div class="my-pic">
<img src="images/pic/scipyLogo.png" alt="">
</div>



<div class="my-detail">

<div class="white-spacing">
	<h1><a href="http://www.scipy-tutorial.ru">scipy-tutorial.ru</a></h1>
	<span>Научные вычисления</span>
</div> 

<ul class="social-icon">
 <li><a href="https://www.facebook.com/scipyconf" target="_blank" class="facebook"><i class="fa fa-facebook"></i></a></li>
 <li><a href="https://twitter.com/hashtag/scipy" target="_blank" class="twitter"><i class="fa fa-twitter"></i></a></li>
<li><a href="https://github.com/scipy" target="_blank" class="github"><i class="fa fa-github"></i></a></li>
</ul>

</div>
</div>
</div>
<!-- About Me (Left Sidebar) End -->

<!-- Blog Post (Right Sidebar) Start -->
<div class="col-md-9">
<div class="col-md-12 page-body">
<div class="row">
	
<div class="sub-title">
	<h2><a href="index.html">Содержание</a></h2>
 </div>

<div class="col-md-12 content-page">
	<div class="col-md-12 blog-post">

	<!-- Post Headline Start -->
	<div class="post-title">
	<ul class="simple">
	<h3>Ввод/вывод (scipy.io)</h3>
		<li><a class="reference internal" href="#id1">Файлы MATLAB </a>
			<ul>	<li>Основные функции </li>
				<li>Структуры MATLAB </li>
				<li>массивы ячеек MATLAB</li>
			</ul>
		</li>
	</ul>
	</div>
	   <!-- Post Headline End -->
	   

<h3>Файлы MATLAB</h3>
	<p>
Для импорта MATLAB файлов используется пакет scipy.io:
	</p>
		
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">
    >>> import scipy.io as sio
	</pre>
	</div>

	<p>
Среди множества процедур основные:
	</p>
	
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">
sio.loadmat
sio.savemat
sio.whosmat
	</pre>
	</div>

	<p>
Пусть имеется файл .mat, который нужно прочитать в SciPy. Или наоборот, передать некоторые переменные из SciPy / NumPy в MATLAB.

Чтобы избавиться от необходимости покупать лицензию MATLAB, будем работать с GNU Octave. Octave имеет совместимые с MATLAB функции сохранения и загрузки. Введем в командной строке Octave:
	</p>

	<div class="margin-top-40 margin-bottom-40"> 
	<pre class="brush: plain"> 
octave:1> a = 1:12
a =

   1   2   3   4   5   6   7   8   9  10  11  12

octave:2> a = reshape(a, [1 3 4])
a =

ans(:,:,1) =

   1   2   3

ans(:,:,2) =

   4   5   6

ans(:,:,3) =

   7   8   9

ans(:,:,4) =

   10   11   12

octave:3> save -6 octave_a.mat a % MATLAB 6 compatible
octave:4> ls octave_a.mat
octave_a.mat
	</pre>
	</div>
	
	<p>
Код для импорта MATLAB файла в Python:
	</p>
	
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">
    >>> mat_contents = sio.loadmat('octave_a.mat')
    >>> mat_contents
    {'a': array([[[  1.,   4.,   7.,  10.],
            [  2.,   5.,   8.,  11.],
            [  3.,   6.,   9.,  12.]]]),
     '__version__': '1.0',
     '__header__': 'MATLAB 5.0 MAT-file, written by
     Octave 3.6.3, 2013-02-17 21:02:11 UTC',
     '__globals__': []}
    >>> oct_a = mat_contents['a']
    >>> oct_a
    array([[[  1.,   4.,   7.,  10.],
            [  2.,   5.,   8.,  11.],
            [  3.,   6.,   9.,  12.]]])
    >>> oct_a.shape
    (1, 3, 4)
	</pre>
	</div>
	
	<p>	
Теперь рассмотрим экспорт из SciPy в MATLAB:
	</p>
	
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">
    >>> import numpy как np
    >>> vect = np.arange (10)
    >>> vect.shape
    (10,)
    >>> sio.savemat ('np_vector.mat', {'vect': vect})
	</pre>
	</div>

	<p>
Импорт Python файла в Octave:
	</p>
	
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: plain">
octave:8> load np_vector.mat
octave:9> vect
vect =

  0  1  2  3  4  5  6  7  8  9

octave:10> size(vect)
ans =

    1   10
    </pre>
	</div>

	<p>
Если нужно проверить содержимое файла MATLAB без чтения данных в памяти, используйте команду whosmat:
	</p>
	
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">
    >>> sio.whosmat ('octave_a.mat')
    [('a', (1, 3, 4), 'double')]
	</pre>
	</div>

	<p>
whosmat возвращает список кортежей, по одному для каждого массива (или другого объекта) в файле. Каждый кортеж содержит имя, содержание и тип данных.
	</p>
	
<h3>Структуры MATLAB</h3>
	<p>
Структуры MATLAB немного похожи на Python dicts, за исключением того, что именем поля должна быть строка, а значением поля может быть любой объект. Напомним, что MATLAB - это MATrix LABoratory, поэтому все объекты в MATLAB это матрицы. Даже одно число представляется в виде массива размера (1, 1).
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: plain">	
octave:11> my_struct = struct('field1', 1, 'field2', 2)
my_struct =
{
  field1 =  1
  field2 =  2
}

octave:12> save -6 octave_struct.mat my_struct
	</pre>
	</div>

	<p>
Загрузим MATLAB структуру в Python:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> mat_contents = sio.loadmat('octave_struct.mat')
    >>> mat_contents
    {'my_struct': array([[([[1.0]], [[2.0]])]],
          dtype=[('field1', 'O'), ('field2', 'O')]), '__version__': '1.0', '__header__': 'MATLAB 5.0 MAT-file, written by Octave 3.6.3, 2013-02-17 21:23:14 UTC', '__globals__': []}
    >>> oct_struct = mat_contents['my_struct']
    >>> oct_struct.shape
    (1, 1)
    >>> val = oct_struct[0,0]
    >>> val
    ([[1.0]], [[2.0]])
    >>> val['field1']
    array([[ 1.]])
    >>> val['field2']
    array([[ 2.]])
    >>> val.dtype
    dtype([('field1', 'O'), ('field2', 'O')])
	</pre>
	</div>

	<p>
В версиях SciPy от 0.12.0 структуры MATLAB возвращаются как структурированные массивы numpy. Названия полей массива numpy совпадают с названием полей структуры MATLAB. Имена полей можно прочитать с помощью команды dtype, как в примере выше. Также обратите внимание:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">		
    >>> val = oct_struct [0,0]
	</pre>
	</div>
	
	<p>
а также:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: plain">	
octave:13> size(my_struct)
ans =

   1   1
	</pre>
	</div>
	
	<p>
Таким образом, в MATLAB массив структур имеет размер как минимум 2D, что повторяется при чтении в SciPy. Если нужно сжать размерность до 1, попробуйте следующее:
	</p>
	
	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> mat_contents = sio.loadmat ('octave_struct.mat', squeeze_me = True)
    >>> oct_struct = mat_contents ['my_struct']
    >>> oct_struct.shape
    ()
	</pre>
	</div>
	
	<p>
Иногда удобнее загружать структуры MATLAB как объекты python, а не numpy  массивы. Это может сделать синтаксис python немного более похожим на MATLAB. Чтобы это сделать, используйте параметр struct_as_record = False для загрузки.
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> mat_contents = sio.loadmat ('octave_struct.mat', struct_as_record = False)
    >>> oct_struct = mat_contents ['my_struct']
    >>> oct_struct [0,0] .field1
    array ([[1.]])
	</pre>
	</div>

	<p>
struct_as_record = False прекрасно работает с squeeze_me:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> mat_contents = sio.loadmat('octave_struct.mat', struct_as_record=False, squeeze_me=True)
    >>> oct_struct = mat_contents['my_struct']
    >>> oct_struct.shape # but no - it's a scalar
    Traceback (most recent call last):
      File "< stdin >", line 1, in < module >
    AttributeError: 'mat_struct' object has no attribute 'shape'
    >>> type(oct_struct)
    < class 'scipy.io.matlab.mio5_params.mat_struct'>
    >>> oct_struct.field1
    1.0
	</pre>
	</div>
		
	<p>
Сохранение массивов структур может осуществляться по-разному. Один простой способ - использовать dicts:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> a_dict = {'field1': 0.5, 'field2': 'a string'}
    >>> sio.savemat ('saved_struct.mat', {'a_dict': a_dict})
	</pre>
	</div>
	
	<p>
В MATLAB загружается как:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: plain">		
octave:21> load saved_struct
octave:22> a_dict
a_dict =

  scalar structure containing the fields:

    field2 = a string
    field1 =  0.50000
	</pre>
	</div>
	
	<p>
Также можно сохранить структуры снова в MATLAB (или Octave в нашем случае) следующим образом:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> dt = [('f1', 'f8'), ('f2', 'S10')]
    >>> arr = np.zeros ((2,), dtype = dt)
    >>> arr
    array ([(0.0, ''), (0.0, '')],
          dtype = [('f1', ' < f8'), ('f2', 'S10')])
    >>> arr [0] ['f1'] = 0.5
    >>> arr [0] ['f2'] = 'python'
    >>> arr [1] ['f1'] = 99
    >>> arr [1] ['f2'] = 'not perl'
    >>> sio.savemat ('np_struct_arr.mat', {'arr': arr})
	</pre>
	</div>
	
<h3>Массивы ячеек (cell) MATLAB</h3>
	
	<p>
Массивы ячеек (cell) в MATLAB похожи на списки python, в том смысле, что элементы в массивах могут содержать любой тип объекта MATLAB. Но больше всего они похожи на массивы объектов numpy, и именно так мы загружаем их в numpy.
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: plain">	
octave:14> my_cells = {1, [2, 3]}
my_cells =
{
  [1,1] =  1
  [1,2] =

     2   3

}

octave:15> save -6 octave_cells.mat my_cells
	</pre>
	</div>
	
	<p>
Вернемся к Python:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> mat_contents = sio.loadmat ('octave_cells.mat')
    >>> oct_cells = mat_contents ['my_cells']
    >>> print (oct_cells.dtype)
    объект
    >>> val = oct_cells [0,0]
    >>> val
    array ([[1.]])
    >>> print (val.dtype)
    float64
	</pre>
	</div>
	
	<p>
Сохранение в массив ячеек MATLAB просто включает создание массива объектов numpy:
	</p>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: python">	
    >>> obj_arr = np.zeros ((2,), dtype = np.object)
    >>> obj_arr [0] = 1
    >>> obj_arr [1] = 'a string'
    >>> obj_arr
    array ([1, 'string'], dtype = object)
    >>> sio.savemat ('np_cells.mat', {'obj_arr': obj_arr})
	</pre>
	</div>

	<div class="margin-top-40 margin-bottom-40">  
	<pre class="brush: plain">
octave:16> load np_cells.mat
octave:17> obj_arr
obj_arr =
{
  [1,1] = 1
  [2,1] = a string
}
	</pre>
	</div>


</div>
 
</div>

</div>	
		 


<!-- Footer Start -->
<div class="col-md-12 page-body margin-top-50 footer">
  <footer>
  <ul class="menu-link">
	   <li><a href="index.html">Содержание</a></li>
	   <li><a href="about.html">О сайте</a></li>
	</ul>
	
  <p>© Copyright 2019. All rights reserved. </p>
  
						  
  <!-- UiPasta   Credit Start -->
  <div class="UiPasta  -credit">Design By UiPasta   </div>
  <!-- UiPasta   Credit End -->
  
   
 </footer>
</div>
 <!-- Footer End -->
 
</div>
</div>

   
</div>
</div>
</div>

<!-- Blog Post (Right Sidebar) End -->
    
    
     
     <!-- Endpage Box (Popup When Scroll Down) Start 
     <div id="scroll-down-popup" class="endpage-box">
       <h4>Read Also</h4>
       <a href="#">How to make your company website based on bootstrap framework...</a>
      </div>
      < !-- Endpage Box (Popup When Scroll Down) End -->
      
    
    
    
    <!-- Back to Top Start -->
    <a href="#" class="scroll-to-top"><i class="fa fa-long-arrow-up"></i></a>
    <!-- Back to Top End -->
    
    
    <!-- All Javascript Plugins  -->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/plugin.js"></script>
    
    <!-- Main Javascript File  -->
    <script type="text/javascript" src="js/scripts.js"></script>
    
    <!-- Syntax Highlighter Javascript File  -->
    <script type="text/javascript" src="js/syntax/shCore.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushCss.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushJScript.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPerl.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPhp.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPlain.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPython.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushRuby.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushSql.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushVb.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushXml.js"></script>
    
	<!-- Syntax Highlighter Call Function -->
	<script type="text/javascript">
		SyntaxHighlighter.config.clipboardSwf = 'js/syntax/clipboard.swf';
		SyntaxHighlighter.all();
	</script>

    
   </body>
 </html>
